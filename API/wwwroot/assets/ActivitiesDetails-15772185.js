import{W as j,X as u,a9 as P,a0 as _,$ as K,C as D,N as S,D as e,S as f,H,I as R,O as X,K as L,L as M,M as b,J as A,r as T,am as U,F as Y,G as q,aj as W}from"./index-a9b4d80b.js";import{I as g,G as d}from"./Item-73c99ef0.js";import{L as J}from"./List-e5b67418.js";import{C as x}from"./Comment-aa3f3fee.js";import{F as V,a as B,b as Q}from"./formik.esm-64656d3e.js";import{c as Z,a as ee}from"./index.esm-82c90a4b.js";import{e as re,b as te,d as ne,a as $}from"./index-2cb0c1a5.js";import"./tiny-warning.esm-c932d744.js";import"./_copyArray-2696d1fd.js";function C(r,n){j(2,arguments);var t=u(r),i=u(n),s=t.getTime()-i.getTime();return s<0?-1:s>0?1:s}function se(r,n){return j(2,arguments),u(r).getTime()-u(n).getTime()}var E={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(n){return n<0?Math.ceil(n):Math.floor(n)}},ae="trunc";function ie(r){return r?E[r]:E[ae]}function oe(r){j(1,arguments);var n=u(r);return re(n).getTime()===te(n).getTime()}function le(r,n){j(2,arguments);var t=u(r),i=u(n),s=C(t,i),l=Math.abs(ne(t,i)),a;if(l<1)a=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*l);var h=C(t,i)===-s;oe(u(r))&&l===1&&C(r,i)===1&&(h=!1),a=s*(l-Number(h))}return a===0?0:a}function ce(r,n,t){j(2,arguments);var i=se(r,n)/1e3;return ie(t==null?void 0:t.roundingMethod)(i)}function de(r){return $({},r)}var O=1440,ue=2520,I=43200,fe=86400;function me(r,n,t){var i,s;j(2,arguments);var l=K(),a=(i=(s=t==null?void 0:t.locale)!==null&&s!==void 0?s:l.locale)!==null&&i!==void 0?i:P;if(!a.formatDistance)throw new RangeError("locale must contain formatDistance property");var h=C(r,n);if(isNaN(h))throw new RangeError("Invalid time value");var o=$(de(t),{addSuffix:!!(t!=null&&t.addSuffix),comparison:h}),m,y;h>0?(m=u(n),y=u(r)):(m=u(r),y=u(n));var v=ce(y,m),z=(_(y)-_(m))/1e3,c=Math.round((v-z)/60),p;if(c<2)return t!=null&&t.includeSeconds?v<5?a.formatDistance("lessThanXSeconds",5,o):v<10?a.formatDistance("lessThanXSeconds",10,o):v<20?a.formatDistance("lessThanXSeconds",20,o):v<40?a.formatDistance("halfAMinute",0,o):v<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):c===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",c,o);if(c<45)return a.formatDistance("xMinutes",c,o);if(c<90)return a.formatDistance("aboutXHours",1,o);if(c<O){var F=Math.round(c/60);return a.formatDistance("aboutXHours",F,o)}else{if(c<ue)return a.formatDistance("xDays",1,o);if(c<I){var k=Math.round(c/O);return a.formatDistance("xDays",k,o)}else if(c<fe)return p=Math.round(c/I),a.formatDistance("aboutXMonths",p,o)}if(p=le(y,m),p<12){var G=Math.round(c/I);return a.formatDistance("xMonths",G,o)}else{var w=p%12,N=Math.floor(p/12);return w<3?a.formatDistance("aboutXYears",N,o):w<9?a.formatDistance("overXYears",N,o):a.formatDistance("almostXYears",N+1,o)}}function he(r,n){return j(1,arguments),me(r,Date.now(),n)}const xe={filter:"brightness(30%)"},ge={position:"absolute",bottom:"5%",left:"5%",width:"100%",height:"auto",color:"white"},je=D(({activity:r})=>{var l,a;const{activityStore:{updateAttendance:n,loading:t,cancelActivityToggle:i}}=S(),s=()=>r.isHost?e.jsxs(e.Fragment,{children:[e.jsx(b,{color:r.isCanceled?"green":"red",floated:"left",basic:!0,content:r.isCanceled?"Re-activate Activity":"Cancel Activity",onClick:i,loading:t}),e.jsx(b,{disabled:r.isCanceled,loading:t,as:M,to:`/manage/${r.id}`,color:"orange",floated:"right",children:"Manage Event"})]}):r.isGoing?e.jsx(b,{loading:t,onClick:n,children:"Cancel attendance"}):e.jsx(b,{disabled:r.isCanceled,loading:t,onClick:n,color:"teal",children:"Join attendance"});return e.jsxs(f.Group,{children:[e.jsxs(f,{basic:!0,attached:"top",style:{padding:"0"},children:[r.isCanceled&&e.jsx(H,{style:{position:"absolute",zIndex:1e3,left:-14,top:20},ribbon:!0,color:"red",content:"Cancelled"}),e.jsx(R,{src:`/assets/categoryImages/${r.category}.jpg`,fluid:!0,style:xe}),e.jsx(f,{style:ge,basic:!0,children:e.jsx(g.Group,{children:e.jsx(g,{children:e.jsxs(g.Content,{children:[e.jsx(X,{size:"huge",content:r.title,style:{color:"white"}}),e.jsx("p",{children:L(r.date,"dd MMM yyyy")}),e.jsxs("p",{children:["Hosted by"," ",e.jsx("strong",{children:e.jsx(M,{to:`/profiles/${(l=r.host)==null?void 0:l.userName}`,children:(a=r.host)==null?void 0:a.displayName})})]})]})})})})]}),e.jsx(f,{clearing:!0,attached:"bottom",children:e.jsx(s,{})})]})}),ve=D(({activity:r})=>e.jsxs(f.Group,{children:[e.jsx(f,{attached:"top",children:e.jsxs(d,{children:[e.jsx(d.Column,{width:1,children:e.jsx(A,{size:"large",color:"teal",name:"info"})}),e.jsx(d.Column,{width:15,children:e.jsx("p",{children:r.description})})]})}),e.jsx(f,{attached:!0,children:e.jsxs(d,{verticalAlign:"middle",children:[e.jsx(d.Column,{width:1,children:e.jsx(A,{name:"calendar",size:"large",color:"teal"})}),e.jsx(d.Column,{width:15,children:e.jsx("span",{children:L(r.date,"dd MMM yyyy h:mm aa")})})]})}),e.jsx(f,{attached:!0,children:e.jsxs(d,{verticalAlign:"middle",children:[e.jsx(d.Column,{width:1,children:e.jsx(A,{name:"marker",size:"large",color:"teal"})}),e.jsx(d.Column,{width:11,children:e.jsxs("span",{children:[r.venue,", ",r.city]})})]})})]})),pe=D(({activity:{attendees:r,host:n}})=>r?e.jsxs(e.Fragment,{children:[e.jsxs(f,{textAlign:"center",style:{border:"none"},attached:"top",secondary:!0,inverted:!0,color:"teal",children:[r.length," ",r.length===1?"Person":"People"," ","going"]}),e.jsx(f,{attached:!0,children:e.jsx(J,{relaxed:!0,divided:!0,children:r.slice().sort((t,i)=>t.userName===(n==null?void 0:n.userName)?-1:i.userName===(n==null?void 0:n.userName)?1:t.userName.localeCompare(i.userName)).map(t=>e.jsxs(g,{style:{position:"relative"},children:[t.userName===(n==null?void 0:n.userName)&&e.jsx(H,{style:{position:"absolute"},color:"orange",ribbon:"right",children:"Host"}),e.jsx(R,{style:{float:"left"},as:M,to:`/profiles/${t.userName}`,size:"tiny",src:t.image??"/assets/user.png"}),e.jsxs(g.Content,{verticalAlign:"middle",children:[e.jsx(g.Header,{as:"h3",children:e.jsx(M,{to:`/profiles/${t.userName}`,children:t.displayName})}),t.following&&e.jsx(g.Extra,{style:{color:"orange"},children:"Following"})]})]},t.userName))})})]}):null),Me=D(({activityId:r})=>{const[n,t]=T.useState(!1),{commentStore:i}=S();return T.useEffect(()=>(r&&!n&&(i.createHubConnection(r),t(!0)),()=>{n&&i.clearComments()}),[i,r,n,t]),e.jsxs(e.Fragment,{children:[e.jsx(f,{textAlign:"center",attached:"top",inverted:!0,color:"teal",style:{border:"none"},children:e.jsx(X,{children:"Chat about this event"})}),e.jsxs(f,{attached:!0,clearing:!0,children:[e.jsx(V,{onSubmit:(s,{resetForm:l})=>i.addComments(s).then(()=>{l()}),initialValues:{body:""},validationSchema:Z({body:ee().required("Comment required")}),children:({isSubmitting:s,isValid:l,handleSubmit:a,dirty:h})=>e.jsxs(B,{className:"ui form",children:[e.jsx(Q,{name:"body",children:o=>e.jsxs("div",{style:{position:"relative"},children:[e.jsx(U,{active:s}),e.jsx("textarea",{placeholder:"Enter your comments (Press Enter to submit, SHIFT + Enter for new line",rows:2,...o.field,onKeyDown:m=>{m.key==="Enter"&&m.shiftKey||m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),l&&a())}})]})}),e.jsx(b,{loading:s,disabled:s||!h||!l,content:"Add Reply",labelPosition:"left",icon:"edit",primary:!0,type:"submit",style:{display:"flex",marginTop:"10px",zIndex:999},floated:"right"})]})}),e.jsx(x.Group,{children:i.comments.map(s=>e.jsxs(x,{children:[e.jsx(x.Avatar,{as:M,to:`/profiles/${s.username}`,src:s.image??"/assets/user.png"}),e.jsxs(x.Content,{children:[e.jsx(x.Author,{as:M,to:`/profiles/${s.username}`,children:s.displayName}),e.jsx(x.Metadata,{children:e.jsxs("div",{children:[he(s.createdAt)," ago"]})}),e.jsx(x.Text,{style:{whiteSpace:"pre-wrap"},children:s.body})]})]},s.id))})]})]})}),{LoadingComponent:ye}=Y(()=>q(()=>import("./index-a9b4d80b.js").then(r=>r.c8),["assets/index-a9b4d80b.js","assets/index-2376a3f3.css"])),_e=D(()=>{const{activityStore:r}=S(),{selectedActivity:n,loadActivity:t,loadingInitial:i,clearSelectedActivity:s}=r,{id:l}=W();return T.useEffect(()=>(l&&t(l),()=>{s()}),[l,t,s]),i||!n?e.jsx(ye,{}):e.jsxs(d,{children:[e.jsxs(d.Column,{width:10,children:[e.jsx(je,{activity:n}),e.jsx(ve,{activity:n}),e.jsx(Me,{activityId:n.id})]}),e.jsx(d.Column,{width:6,children:e.jsx(pe,{activity:n})})]})});export{_e as ActivityDetails};
